## **Improper Convergence Checks**

**Vulnerability Pattern:** Business Logic

**Severity:** Low

**Ecosystem:** Sui

**Protocol:** Aftermath

**Auditor:** OtterSec

**Report:** 

[https://ottersec.notion.site/Sampled-Public-Audit-Reports-a296e98838aa4fdb8f3b192663400772](https://www.notion.so/a296e98838aa4fdb8f3b192663400772?pvs=21)

**Report Date:** May 2023

**Description:** 

In the geometric_mean_calculations.move module within the following functions: calc_swap_fixed_in, calc_swap_fixed_out, calc_withdraw_fixed_amounts, and calc_deposit_fixed_amounts, the convergence between prev_t and t is checked after the while loop. However, this approach will properly execute because the t value is copied into the prev_t variable at the end of the loop.

**Recommendation:** 

Check the convergence between prev_t and t using i_t. If temp becomes convergent within the while loop, i_t will be smaller than MAX_NEWTONS_METHOD_ITERATIONS and may exit the while loop via a break statement. However, if temp does not converge, i_t will reach MAX_NEWTONS_METHOD_ITERATIONS, causing the while loop to finish.

**Coding/Auditing Tip:** Can the loop exit without convergence (timeout/max iterations)?
