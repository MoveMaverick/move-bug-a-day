## **Lack of validation in setting and retrieving default domain names**

**Vulnerability Pattern:** Input Validation

**Severity:** Low

**Ecosystem:** Sui

**Protocol:** MystenLabs Sui

**Auditor:** OtterSec

**Report:** 

[https://ottersec.notion.site/Sampled-Public-Audit-Reports-a296e98838aa4fdb8f3b192663400772](https://www.notion.so/a296e98838aa4fdb8f3b192663400772?pvs=21)

**Report Date:** May 2023

**Description:** 

In registry.move, set_default_domain_name sets the value of the new
default_domain_name, however, several checks are missing.

1. The function does not check if new_default_domain_name exists or if the sender is its owner.
2. The function only permits modifying the default domain name setting for subdomains of
addr.reverse, leaving the field empty for all other domains.
3. The default domain name still points to the same domain if the owner changes.
4. The default domain name should not be accessible through any other public functions. However,
registry::get_name_record_all_fields returns the default domain name without validation.

**Coding/Auditing Tip:** Ensure that all parameters have been properly validated.